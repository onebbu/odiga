<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.odiga.mytrip.search.dao.SearchDAO">


    <!-- 여행지 지역별 리스트 가져오기 -->
    <select id="getSearchList" resultType="com.odiga.mytrip.search.vo.SearchVO" parameterType="String">
        SELECT *
    FROM (
        SELECT t.*, ROW_NUMBER() OVER (ORDER BY t.title) AS row_num
        FROM travellist t
        WHERE t.title LIKE '%' || #{text} || '%'
        AND t.areacode = #{areacode}
    ) sub
    WHERE sub.row_num BETWEEN ((#{page} - 1) * 10 + 1) AND (#{page} * 10)

    </select>

    <select id="getResultCount" resultType="int">
    SELECT COUNT(*)
    FROM TRAVELLIST
    WHERE areacode = #{areacode}
    AND title LIKE '%' || #{text} || '%'
    </select>

    <select id="getCatList" resultType="com.odiga.mytrip.search.vo.CatVO">
    SELECT *
    FROM TRAVELCAT
    </select>

    <!-- 여행지별 리뷰 평균 별점 조회 placeList에서 가져온거 커스텀해야함.
    <select id="getPlaceRate" resultType="java.util.Map" parameterType="String">
        SELECT NVL(ROUND(AVG(REVIEWGRADE)),0) AS "averageRate", count(*) as "cntRating"
        FROM TRAVELREVIEW
        WHERE contentid = #{contentID}
    </select> -->
</mapper>